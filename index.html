<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <title>ูุธุงู ุฅุฏุงุฑุฉ ุงููุฎุชุจุฑ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="logo">
                <img id="sidebarLogo" src="images/logo.png" alt="ุดุนุงุฑ ุงููุฎุชุจุฑ" style="display: none;">
                <h2 id="sidebarLabName">ูุธุงู ุงููุฎุชุจุฑ</h2>
            </div>
            <nav class="menu">
                <a href="#dashboard" class="menu-item active">ููุญุฉ ุงูุชุญูู</a>
                <a href="#today-cases" class="menu-item">ุญุงูุงุช ุงูููู</a>
                <a href="#patients" class="menu-item">ุฅุฏุงุฑุฉ ุงููุฑุถู</a>
                <a href="#tests" class="menu-item">ุฅุฏุงุฑุฉ ุงููุญูุตุงุช</a>
                <a href="#results" class="menu-item">ูุชุงุจุฉ ุงููุชุงุฆุฌ</a>
                <a href="#test-definitions" class="menu-item">ุฃููุงุน ุงูุชุญุงููู</a>
                <a href="#inventory" class="menu-item" id="inventory-nav">ุฅุฏุงุฑุฉ ุงููุฎุฒูู</a>
                <a href="#consumed" class="menu-item" id="consumed-nav">ุงููุณุชูููุงุช</a>
                <a href="#settings" class="menu-item" id="settings-nav">ุงูุฅุนุฏุงุฏุงุช</a>
                <a href="#archive" class="menu-item" id="archive-nav">ุงูุฃุฑุดูู</a>
                <a href="#" id="logoutBtn" class="menu-item">ุชุณุฌูู ุงูุฎุฑูุฌ</a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
          <header>
              <h1>ููุญุฉ ุงูุชุญูู</h1>
              <div class="header-right">
                  <input type="text" id="searchInput" placeholder="ุงุจุญุซ ูู ุงูุฌุฏูู ุงูุญุงูู..." class="search-input">
                  <button id="theme-toggle" class="theme-btn">๐</button>
              </div>
          </header>

            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <div class="cards">
                    <div class="card">
                        <h3>ุฅุฌูุงูู ุงููุฑุถู</h3>
                        <p id="totalPatients">0</p>
                    </div>
                    <div class="card">
                        <h3>ุงููุญูุตุงุช ุงููุนููุฉ</h3>
                        <p id="pendingTests">0</p>
                    </div>
                    <div class="card">
                        <h3>ุฅุฌูุงูู ุงููุชุงุฆุฌ</h3>
                        <p id="totalResults">0</p>
                    </div>
                    <div class="card">
                        <h3>ุฃููุงุน ุงูุชุญุงููู</h3>
                        <p id="totalTestDefs">0</p>
                    </div>
                    <div class="card">
                        <h3>ุงููุฎุฒูู ุงูููุฎูุถ</h3>
                        <p id="lowStockItems">0</p>
                    </div>
                </div>
                <div class="charts-container">
                    <div class="chart-card">
                        <h3>ุญุงูุฉ ุงููุญูุตุงุช</h3>
                        <canvas id="testsStatusChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>ุงููุญูุตุงุช ุญุณุจ ุงูููุน</h3>
                        <canvas id="testsByTypeChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Today's Cases Section -->
            <section id="today-cases" class="content-section">
                <div class="table-header">
                    <h2>ููุฎุต ุญุงูุงุช ุงูููู</h2>
                    <button id="printTodayReportBtn" class="export-btn" style="background-color: #3498db;">ุทุจุงุนุฉ ุชูุฑูุฑ ุงูููู</button>
                </div>
                <div class="cards">
                    <div class="card">
                        <h3>ุฅุฌูุงูู ูุญูุตุงุช ุงูููู</h3>
                        <p id="todayTotalTests">0</p>
                    </div>
                    <div class="card">
                        <h3>ุงููุญูุตุงุช ุงูููุชููุฉ ุงูููู</h3>
                        <p id="todayCompletedTests">0</p>
                    </div>
                    <div class="card">
                        <h3>ุงููุญูุตุงุช ุงููุนููุฉ ุงูููู</h3>
                        <p id="todayPendingTests">0</p>
                    </div>
                </div>
                <hr>
                <h2>ุงููุญูุตุงุช ุงููุนููุฉ ุงูููู</h2>
                <table id="todayPendingTestsTable">
                    <thead><tr><th>ุงุณู ุงููุฑูุถ</th><th>ููุน ุงููุญุต</th></tr></thead>
                    <tbody></tbody>
                </table>
                <hr>
                <h2>ุงููุญูุตุงุช ุงูููุชููุฉ ุงูููู</h2>
                <table id="todayCompletedTestsTable">
                    <thead><tr><th>ุงุณู ุงููุฑูุถ</th><th>ููุน ุงููุญุต</th></tr></thead>
                    <tbody></tbody>
                </table>
            </section>

            <!-- Patients Section -->
            <section id="patients" class="content-section">
                <h2>ุฅุถุงูุฉ ูุฑูุถ ุฌุฏูุฏ</h2>
                <form id="patientForm">
                    <input type="text" id="patientNationalId" placeholder="ุงูุฑูู ุงููุทูู" required>
                    <input type="text" id="patientName" placeholder="ุงุณู ุงููุฑูุถ" required>
                    <input type="number" id="patientAge" placeholder="ุงูุนูุฑ" required>
                    <select id="patientGender" required>
                        <option value="" disabled selected>ุงุฎุชุฑ ุงูุฌูุณ</option>
                        <option value="ุฐูุฑ">ุฐูุฑ</option>
                        <option value="ุฃูุซู">ุฃูุซู</option>
                    </select>
                    <input type="tel" id="patientPhone" placeholder="ุฑูู ุงููุงุชู">
                    <textarea id="patientRecord" placeholder="ุงูุณุฌู ุงูุทุจู"></textarea>
                    <button type="submit">ุฅุถุงูุฉ ูุฑูุถ</button>
                </form>
                <hr>
                <div class="table-header">
                    <h2>ูุงุฆูุฉ ุงููุฑุถู</h2>
                    <button id="exportPatientsBtn" class="export-btn">ุชุตุฏูุฑ ุฅูู Excel</button>
                </div>
                <table id="patientsTable">
                    <thead>
                        <tr>
                            <th>ุงููุนุฑู</th>
                            <th>ุงูุฑูู ุงููุทูู</th>
                            <th>ุงูุงุณู</th>
                            <th>ุงูุนูุฑ</th>
                            <th>ุงูุฌูุณ</th>
                            <th>ุงููุงุชู</th>
                            <th>ุงูุณุฌู ุงูุทุจู</th>
                            <th>ุฅุฌุฑุงุกุงุช</th>
                            <th>ุงูููู ุงูุดุฎุตู</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>

            <!-- Patient Profile Section -->
            <section id="patient-profile" class="content-section">
                <div id="patient-profile-header">
                    <button id="backToPatientsBtn" class="back-btn">โก๏ธ ุงูุนูุฏุฉ ููุงุฆูุฉ ุงููุฑุถู</button>
                </div>
                <div id="patient-profile-info">
                    <!-- Patient details will be injected here -->
                </div>
                <hr>
                <div class="table-header">
                    <h2>ุชุงุฑูุฎ ุงูุชุญุงููู</h2>
                    <button id="printSelectedTestsBtn" class="action-btn" style="background-color: #3498db;">ุทุจุงุนุฉ ุงูุชุญุงููู ุงููุญุฏุฏุฉ</button>
                </div>
                <table id="patientProfileTestsTable">
                    <thead>
                        <tr>
                            <th>ุชุญุฏูุฏ</th>
                            <th>#</th>
                            <th>ููุน ุงููุญุต</th>
                            <th>ุชุงุฑูุฎ ุงูุทูุจ</th>
                            <th>ุงูุญุงูุฉ</th>
                            <th>ุทุจุงุนุฉ</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>

            <!-- Tests Section -->
            <section id="tests" class="content-section">
                <h2>ุชุณุฌูู ุทูุจ ูุญุต ุฌุฏูุฏ</h2>
                <form id="testForm">
                    <select id="testPatientId" required>
                        <option value="" disabled selected>ุงุฎุชุฑ ูุฑูุถุงู</option>
                    </select>
                    <input type="text" id="testTypeSearch" placeholder="ุงุจุญุซ ุนู ููุน ุงููุญุต..." style="grid-column: 1 / -1;">
                    <div id="testTypesContainer" class="checkbox-container"></div>
                    <button type="submit">ุฅุถุงูุฉ ุงููุญูุตุงุช ุงููุญุฏุฏุฉ</button>
                </form>
                <hr>
                <div class="table-header">
                    <h2>ูุงุฆูุฉ ุงููุญูุตุงุช</h2>
                    <button id="exportTestsBtn" class="export-btn">ุชุตุฏูุฑ ุฅูู Excel</button>
                </div>
                <table id="testsTable">
                    <thead>
                        <tr>
                            <th>ูุนุฑู ุงููุญุต</th>
                            <th>ุงุณู ุงููุฑูุถ</th>
                            <th>ููุน ุงููุญุต</th>
                            <th>ุชุงุฑูุฎ ุงูุทูุจ</th>
                            <th>ุงูุญุงูุฉ</th>
                            <th>ุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>

            <!-- Results Section -->
            <section id="results" class="content-section">
                <h2>ูุชุงุจุฉ ูุชูุฌุฉ ุงูุชุญููู</h2>
                <form id="resultForm">
                    <select id="resultTestId" required>
                        <option value="" disabled selected>ุงุฎุชุฑ ูุญุตูุง ูุฅุถุงูุฉ ูุชูุฌุฉ</option>
                    </select>
                    <div id="result-parameters-container" class="parameters-container"></div>
                    <textarea id="resultNotes" placeholder="ููุงุญุธุงุช ุนุงูุฉ (ุงุฎุชูุงุฑู)"></textarea>
                    <button type="submit">ุญูุธ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ</button>
                </form>
                <hr>
                <div class="table-header">
                    <h2>ูุงุฆูุฉ ุงููุชุงุฆุฌ ุงููุณุฌูุฉ</h2>
                    <button id="exportResultsBtn" class="export-btn">ุชุตุฏูุฑ ุฅูู Excel</button>
                </div>
                <table id="resultsTable">
                    <thead>
                        <tr>
                            <th>ูุนุฑู ุงููุชูุฌุฉ</th>
                            <th>ุงุณู ุงููุฑูุถ</th>
                            <th>ููุน ุงููุญุต</th>
                            <th>ููุงุญุธุงุช ุนุงูุฉ</th>
                            <th>ุชุงุฑูุฎ ุงูุฅุฏุฎุงู</th>
                            <th>ุฅุฌุฑุงุกุงุช / ุทุจุงุนุฉ</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>

            <!-- Test Definitions Section -->
            <section id="test-definitions" class="content-section">
                <h2>ุฅุถุงูุฉ ููุน ุชุญููู ุฌุฏูุฏ</h2>
                <form id="testDefinitionForm">
                    <input type="text" id="testDefName" placeholder="ุงุณู ุงููุญุต (ูุซุงู: ุตูุฑุฉ ุฏู ูุงููุฉ)" required>
                    
                    <div class="sub-form-container">
                        <h4>ุงูุชุญุงููู ุงููุฑุนูุฉ (Parameters)</h4>
                        <div id="testDefParametersContainer"></div>
                        <button type="button" id="addTestDefParamBtn" class="add-btn">ุฅุถุงูุฉ ุชุญููู ูุฑุนู</button>
                    </div>
                    <div class="sub-form-container">
                        <h4>ุงูููุงุฏ ุงููุณุชูููุฉ</h4>
                        <div id="testDefMaterialsList"></div>
                        <button type="button" id="openMaterialsModalBtn" class="add-btn">ุงุฎุชูุงุฑ ุงูููุงุฏ</button>
                    </div>
                    
                    <button type="submit">ุญูุธ ููุน ุงูุชุญููู</button>
                </form>
                <hr>
                <h2>ูุงุฆูุฉ ุฃููุงุน ุงูุชุญุงููู</h2>
                <table id="testDefinitionsTable">
                    <thead>
                        <tr>
                            <th>ุงุณู ุงููุญุต</th>
                            <th>ุงูุชุญุงูiles ุงููุฑุนูุฉ</th>
                            <th>ุงูููุงุฏ ุงููุณุชูููุฉ</th>
                            <th>ุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>

            <!-- Inventory Section -->
            <section id="inventory" class="content-section">
                <h2>ุฅุถุงูุฉ ูุงุฏุฉ ุฌุฏูุฏุฉ ูููุฎุฒูู</h2>
                <form id="inventoryForm">
                    <input type="text" id="itemName" placeholder="ุงุณู ุงููุงุฏุฉ" required>
                    <input type="text" id="itemUnit" placeholder="ูุญุฏุฉ ุงูููุงุณ (ml, kit, ...)" required>
                    <input type="number" id="currentStock" placeholder="ุงููููุฉ ุงูุญุงููุฉ" required>
                    <input type="number" id="reorderLevel" placeholder="ุญุฏ ุฅุนุงุฏุฉ ุงูุทูุจ" required>
                    <button type="submit">ุฅุถุงูุฉ ูููุฎุฒูู</button>
                </form>
                <hr>
                <div class="table-header">
                    <h2>ุญุงูุฉ ุงููุฎุฒูู</h2>
                    <button id="exportInventoryBtn" class="export-btn">ุชุตุฏูุฑ ุฅูู Excel</button>
                </div>
                <table id="inventoryTable">
                    <thead>
                        <tr>
                            <th>ุงููุนุฑู</th>
                            <th>ุงุณู ุงููุงุฏุฉ</th>
                            <th>ุงููููุฉ ุงููุณุชูููุฉ</th>
                            <th>ุงููููุฉ ุงูุญุงููุฉ (ุงููุญุฏุฉ)</th>
                            <th>ุญุฏ ุฅุนุงุฏุฉ ุงูุทูุจ</th>
                            <th>ุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>

            <!-- Consumed Log Section -->
            <section id="consumed" class="content-section">
                <div class="table-header">
                    <h2>ุณุฌู ุงูููุงุฏ ุงููุณุชูููุฉ</h2>
                    <button id="exportConsumedBtn" class="export-btn">ุชุตุฏูุฑ ุฅูู Excel</button>
                </div>
                <table id="consumedTable">
                    <thead>
                        <tr>
                            <th>ุงุณู ุงููุงุฏุฉ</th>
                            <th>ุงููููุฉ ุงููุณุชูููุฉ</th>
                            <th>ููุน ุงููุญุต</th>
                            <th>ูุนุฑู ุงููุญุต</th>
                            <th>ุชุงุฑูุฎ ุงูุงุณุชููุงู</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="content-section">
                <h2>ุฅุนุฏุงุฏุงุช ุงููุธุงู ูุงููุฎุชุจุฑ</h2>
                <form id="settingsForm">
                    <input type="text" id="labName" placeholder="ุงุณู ุงููุฎุชุจุฑ" required>
                    <input type="text" id="labAddress" placeholder="ุนููุงู ุงููุฎุชุจุฑ">
                    <input type="tel" id="labPhone" placeholder="ุฑูู ูุงุชู ุงููุฎุชุจุฑ">
                    <input type="email" id="labEmail" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูููุฎุชุจุฑ">
                    
                    <div class="logo-upload-container">
                        <label for="labLogoInput">ุดุนุงุฑ ุงููุฎุชุจุฑ (ููุถู ุฃู ูููู ูุฑุจุนุงู):</label>
                        <input type="file" id="labLogoInput" accept="image/*">
                        <img id="logoPreview" src="" alt="ูุนุงููุฉ ุงูุดุนุงุฑ" style="max-width: 150px; max-height: 150px; margin-top: 10px; display: none;">
                    </div>

                    <div class="sub-form-container">
                        <h4>ุฅุนุฏุงุฏุงุช ุงูุฃุฑุดูุฉ</h4>
                        <label for="archiveDays">ุฃุฑุดูุฉ ุงูุณุฌูุงุช ุงูููุชููุฉ ุชููุงุฆูุงู ุจุนุฏ (ุฃูุงู):</label>
                        <input type="number" id="archiveDays" min="1" style="width: 100px; display: inline-block;">
                    </div>

                    <button type="submit">ุญูุธ ุงูุฅุนุฏุงุฏุงุช</button>
                </form>
                <hr>
                <div class="sub-form-container">
                    <h4>ุงููุณุฎ ุงูุงุญุชูุงุทู ูุงูุงุณุชุนุงุฏุฉ</h4>
                    <p>ููููู ุฃุฎุฐ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุฌููุน ุจูุงูุงุช ุงููุธุงู (ุงููุฑุถูุ ุงููุญูุตุงุชุ ุงููุฎุฒููุ ุฅูุฎ) ูู ููู ูุงุญุฏ. ููููู ุงุณุชุฎุฏุงู ูุฐุง ุงูููู ูุงุญููุง ูุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช ุนูู ูุฐุง ุงูุฌูุงุฒ ุฃู ูููู ุฅูู ุฌูุงุฒ ุขุฎุฑ.</p>
                    <button id="backupBtn" class="action-btn" style="background-color: #f39c12; width: 100%; margin-bottom: 15px;">ุฃุฎุฐ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุงูุขู</button>
                    
                    <label for="restoreInput">ูุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุชุ ุงุฎุชุฑ ููู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ:</label>
                    <input type="file" id="restoreInput" accept=".json">
                    <p style="font-size: 0.8em; color: var(--danger-color);">ุชุญุฐูุฑ: ุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช ุณุชููู ุจุงููุชุงุจุฉ ููู ุฌููุน ุงูุจูุงูุงุช ุงูุญุงููุฉ ูู ุงููุธุงู.</p>
                </div>
                <hr>
                <div class="sub-form-container">
                    <h4>ุงูุฃุฑุดูุฉ ุงููุฏููุฉ</h4>
                    <p>ููููู ุชุดุบูู ุนูููุฉ ุงูุฃุฑุดูุฉ ูุฏูููุง ูู ุฃู ููุช ูููู ุงูุณุฌูุงุช ุงููุฏููุฉ ุฅูู ุงูุฃุฑุดูู ุจูุงุกู ุนูู ุงูุฅุนุฏุงุฏุงุช ุฃุนูุงู.</p>
                    <button id="archiveNowBtn" class="action-btn" style="background-color: #9b59b6; width: 100%;">ุฃุฑุดูุฉ ูุฏููุฉ ุงูุขู</button>
                </div>
            </section>

            <!-- Archive Section -->
            <section id="archive" class="content-section">
                <h2>ุงูุฃุฑุดูู</h2>
                <p>ููุง ุชุธูุฑ ุณุฌูุงุช ุงููุฑุถู ุงูุชู ุชู ุฃุฑุดูุชูุง. ููููู ุนุฑุถูุง ุฃู ุงุณุชุนุงุฏุชูุง ุฅูู ุงููุงุฆูุฉ ุงููุดุทุฉ.</p>
                <table id="archiveTable">
                    <thead>
                        <tr>
                            <th>ุชุงุฑูุฎ ุงูุฃุฑุดูุฉ</th>
                            <th>ุงุณู ุงููุฑูุถ</th>
                            <th>ุนุฏุฏ ุงููุญูุตุงุช</th>
                            <th>ุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>

        </main>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2 id="modalTitle">ุชุนุฏูู ุงูุณุฌู</h2>
            <form id="editForm"></form>
        </div>
    </div>

    <!-- Materials Modal -->
    <div id="materialsModal" class="modal">
        <div class="modal-content wide">
            <span class="close-btn" id="closeMaterialsModalBtn">&times;</span>
            <h2>ุงุฎุชูุงุฑ ุงูููุงุฏ ุงููุณุชูููุฉ</h2>
            <input type="text" id="materialsModalSearch" placeholder="ุงุจุญุซ ุนู ูุงุฏุฉ..." class="search-input" style="width: 100%; margin-bottom: 15px;">
            <div id="materialsModalList" class="modal-list-container">
                <!-- Material items will be injected here -->
            </div>
            <button id="confirmMaterialsSelectionBtn" class="modal-confirm-btn">ุชุฃููุฏ ุงูุงุฎุชูุงุฑ</button>
        </div>
    </div>

    <!-- Print Report Container -->
    <div id="print-report-container">
        <div id="report-content">
            <!-- Content will be injected here by JavaScript -->
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <h2>ุชุณุฌูู ุงูุฏุฎูู</h2>
            <p>ุงูุฑุฌุงุก ุฅุฏุฎุงู ูููุฉ ูุฑูุฑ ุงููุฏูุฑ ูููุตูู ุงููุงููุ ุฃู ุงูุฏุฎูู ูุฒุงุฆุฑ ุจุตูุงุญูุงุช ูุญุฏูุฏุฉ.</p>
            <form id="loginForm">
                <input type="password" id="passwordInput" placeholder="ูููุฉ ุงููุฑูุฑ" autofocus>
                <button type="submit">ุฏุฎูู ููุฏูุฑ</button>
                <button type="button" id="guestLoginBtn">ุงูุฏุฎูู ูุฒุงุฆุฑ</button>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
